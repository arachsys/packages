require keyutils libaio libsodium liburcu lz4

check() {
  url https://api.github.com/repos/koverstreet/bcachefs-tools/branches/master
  match snapshot 20220320 \
    '"date": *"([0-9]{4})-([0-9]{2})-([0-9]{2})' '\1\2\3'
}

prepare() {
  unpack bcachefs-tools-20220320-e76dbf1a.tar.gz \
    https://github.com/koverstreet/bcachefs-tools/archive/e76dbf1abd4472fa26c85f4b30e213d8768ccf64.tar.gz
  apply cosmetic.diff
  apply make.diff
  tree cfa56d9ef90216bc6c214eb215a67888b3753cd7789e7a178852e5b700c2c2d0
}

build() {
  make bcachefs VERSION=20220320-e76dbf1a
  install -s -t /dst/bin -D bcachefs
}
