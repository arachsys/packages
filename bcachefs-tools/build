require keyutils libaio libsodium liburcu lz4

check() {
  url https://api.github.com/repos/koverstreet/bcachefs-tools/branches/master
  match snapshot 20211116 \
    '"date": *"([0-9]{4})-([0-9]{2})-([0-9]{2})' '\1\2\3'
}

prepare() {
  unpack bcachefs-tools-20211116-9a058f14.tar.gz \
    https://github.com/koverstreet/bcachefs-tools/archive/9a058f14283a3591a8b173a667d0b43a8b34c0ae.tar.gz
  apply cosmetic.diff
  apply make.diff
  tree 0627c019f03f2f0840b00a36d9a2b437b2c0b7448dfa12b10861cb1196445293
}

build() {
  make bcachefs VERSION=20211115-9a058f14
  install -s -t /dst/bin -D bcachefs
}
