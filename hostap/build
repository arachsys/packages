require libnl-tiny

check() {
  url https://w1.fi/cgit/hostap/refs/
  match version 2.10 'hostap_([0-9]+)_([0-9]+)\.tar' '\1.\2'
}

prepare() {
  unpack hostap-20240424.tar.gz \
    https://w1.fi/cgit/hostap/snapshot/hostap-1dda619e.tar.gz
  apply libnl.diff
  apply tidy.diff
  tree a94eaf6632b9b69a4e96f3e8f354f70b6bd40dca724ec03ebb072fa160fad9fa
}

build() {
  cp /pkg/config.hostapd hostapd/.config
  make -C hostapd hostapd
  install -s -D hostapd/hostapd /dst/bin/hostapd

  cp /pkg/config.wpad wpa_supplicant/.config
  make -C wpa_supplicant wpa_supplicant
  install -s -D wpa_supplicant/wpa_supplicant /dst/bin/wpad
}
