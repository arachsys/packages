require bison flex

check() {
  url https://www.kernel.org/pub/linux/utils/net/iproute2/
  match version 6.3.0 'iproute2-([0-9.]+)\.tar'
}

prepare() {
  unpack https://www.kernel.org/pub/linux/utils/net/iproute2/iproute2-6.3.0.tar.xz
  apply includes.diff
  apply paths.diff
  apply unspec.diff
  tree ac8b4df4b26e24775fbe669f05dd012c9c94e18bc829f59fc7cb0c2b9bb0d64f
}

build() {
  CC=cc PKG_CONFIG=/bin/false /src/configure
  make install CC=cc DESTDIR=/dst PREFIX= DATADIR=/lib HDRDIR=/lib/include \
    LIBDIR=/lib SBINDIR=/bin {DBM,KERNEL}_INCLUDE=/lib/include
  rm -f -r /dst/bin/{ifcfg,routef,routel,rtpr} /dst/lib/bash-completion
}
