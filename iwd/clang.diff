diff --git a/ell/dbus-filter.c b/ell/dbus-filter.c
index fd61b7c..b9522b5 100644
--- a/ell/dbus-filter.c
+++ b/ell/dbus-filter.c
@@ -309,8 +309,6 @@ unsigned int _dbus_filter_add_rule(struct _dbus_filter *filter,
 
 		}
 
-_Pragma("GCC diagnostic push")
-_Pragma("GCC diagnostic ignored \"-Wmaybe-uninitialized\"")
 		/*
 		 * Mark the condition used.  We do this by setting
 		 * condition->type to an invalid value unless it is the
@@ -332,7 +330,6 @@ _Pragma("GCC diagnostic ignored \"-Wmaybe-uninitialized\"")
 		 * have yet created an AddMatch rule on the server.
 		 */
 		remote_rule |= node->match.remote_rule;
-_Pragma("GCC diagnostic pop")
 	}
 
 	node = l_new(struct filter_node, 1);
@@ -349,11 +346,8 @@ _Pragma("GCC diagnostic pop")
 						rule, rule_len))
 			goto err;
 
-_Pragma("GCC diagnostic push")
-_Pragma("GCC diagnostic ignored \"-Wmaybe-uninitialized\"")
 		parent->id = node->id;
 		parent->match.remote_rule = true;
-_Pragma("GCC diagnostic pop")
 	}
 
 	return node->id;
diff --git a/ell/dhcp.c b/ell/dhcp.c
index be03697..808267c 100644
--- a/ell/dhcp.c
+++ b/ell/dhcp.c
@@ -149,6 +149,7 @@ static void dhcp_message_set_address_type(struct dhcp_message *message,
 	}
 }
 
+__attribute__((unused))
 static inline int dhcp_message_optimize(struct dhcp_message *message,
 					const uint8_t *end)
 {
diff --git a/ell/missing.h b/ell/missing.h
index 2a3e647..b5b6f89 100644
--- a/ell/missing.h
+++ b/ell/missing.h
@@ -71,9 +71,6 @@ static inline void explicit_bzero(void *s, size_t n)
 #ifndef HAVE_RAWMEMCHR
 static inline void *rawmemchr(const void *s, int c)
 {
-_Pragma("GCC diagnostic push")
-_Pragma("GCC diagnostic ignored \"-Wstringop-overflow=\"")
 	return memchr(s, c, (size_t) -1);
-_Pragma("GCC diagnostic pop")
 }
 #endif
diff --git a/ell/util.h b/ell/util.h
index 9d4e36c..ae35fd4 100644
--- a/ell/util.h
+++ b/ell/util.h
@@ -323,7 +323,7 @@ const char *l_util_get_debugfs_path(void);
 	_L_IN_SET_CMP((val), __auto_type, __v == __elems[__i], ##__VA_ARGS__)
 
 #define L_IN_STRSET(val, ...)						\
-	_L_IN_SET_CMP((val), const char *, __v == __elems[__i] ||	\
+	_L_IN_SET_CMP((val), char *, __v == __elems[__i] ||	\
 				(__v && __elems[__i] &&			\
 				 !strcmp(__v, __elems[__i])), ##__VA_ARGS__)
 
diff --git a/src/eap.c b/src/eap.c
index beb106c..10381af 100644
--- a/src/eap.c
+++ b/src/eap.c
@@ -413,11 +413,8 @@ static const char *eap_type_to_str(enum eap_type type, uint32_t vendor_id,
 	return buf;
 }
 
-_Pragma("GCC diagnostic push")
-_Pragma("GCC diagnostic ignored \"-Wmaybe-uninitialized\"")
 #define IS_EXPANDED_RESPONSE(id, t) \
 	(type == EAP_TYPE_EXPANDED && vendor_id == (id) && vendor_type == (t))
-_Pragma("GCC diagnostic pop")
 
 #define RESPONSE_IS(t) \
 	(type == (t) || IS_EXPANDED_RESPONSE(0, (t)))
diff --git a/src/eapol.c b/src/eapol.c
index 19f70b5..2b9fbd1 100644
--- a/src/eapol.c
+++ b/src/eapol.c
@@ -1048,7 +1048,7 @@ static void eapol_set_key_timeout(struct eapol_sm *sm,
  * around this by dropping to O0 for this function when old GCC versions
  * are used
  */
-#if __GNUC__ < 9
+#if __GNUC__ < 9 && !defined(__clang__)
 #pragma GCC optimize ("O0")
 #endif
 
@@ -1095,7 +1095,7 @@ static void eapol_send_ptk_1_of_4(struct eapol_sm *sm)
 	eapol_sm_write(sm, (struct eapol_frame *) ek, false);
 }
 
-#if __GNUC__ < 9
+#if __GNUC__ < 9 && !defined(__clang__)
 #pragma GCC reset_options
 #endif
 
diff --git a/src/missing.h b/src/missing.h
index a5b9295..a65800f 100644
--- a/src/missing.h
+++ b/src/missing.h
@@ -31,10 +31,7 @@ static inline void explicit_bzero(void *s, size_t n)
 #ifndef HAVE_RAWMEMCHR
 static inline void *rawmemchr(const void *s, int c)
 {
-_Pragma("GCC diagnostic push")
-_Pragma("GCC diagnostic ignored \"-Wstringop-overflow=\"")
 	return memchr(s, c, (size_t) -1);
-_Pragma("GCC diagnostic pop")
 }
 #endif
 
diff --git a/src/p2p.c b/src/p2p.c
index 3ae28ed..cf1866c 100644
--- a/src/p2p.c
+++ b/src/p2p.c
@@ -902,7 +902,7 @@ static void p2p_group_event(enum ap_event_type type, const void *event_data,
 	{
 		const struct ap_event_station_added_data *data = event_data;
 		L_AUTO_FREE_VAR(uint8_t *, wfd_data) = NULL;
-		ssize_t wfd_data_len;
+		ssize_t wfd_data_len = 0;
 		struct p2p_association_req req_info;
 		int r;
 
