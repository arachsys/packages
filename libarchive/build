check() {
  url https://github.com/libarchive/libarchive/tags
  match version 3.8.5 'v([0-9.]+)\.tar'
}

prepare() {
  unpack libarchive-3.8.5.tar.xz \
    https://github.com/libarchive/libarchive/releases/download/v3.8.5/libarchive-3.8.5.tar.xz
  apply cosmetic.diff
  tree c1b3b74f2d2bed6befbf0b0419a00a9f39bff459f5220e56aaca246f2dd1d1b1
}

build() {
  auto-config --disable-acl --enable-bsd{cat,cpio,tar}=dynamic \
    --enable-xattr --without-{expat,xml2} --with-{bz2lib,lzma,zlib,zstd}
  make install DESTDIR=/dst
  mv /dst/bin/{bsdcpio,cpio}
  mv /dst/bin/{bsdtar,tar}
}
