diff --git a/usr.sbin/smtpd/ca.c b/usr.sbin/smtpd/ca.c
index 27811bc..2bb68ab 100644
--- a/usr.sbin/smtpd/ca.c
+++ b/usr.sbin/smtpd/ca.c
@@ -31,8 +31,6 @@
 
 #include <openssl/err.h>
 #include <openssl/pem.h>
-#include <openssl/engine.h>
-
 #include <pwd.h>
 #include <signal.h>
 #include <string.h>
@@ -757,8 +755,7 @@ ecdsae_do_verify(const unsigned char *dgst, int dgst_len,
 static void
 rsa_engine_init(void)
 {
-	ENGINE		*e;
-	const char	*errstr, *name;
+	const char	*errstr;
 
 	if ((rsae_method = RSA_meth_new("RSA privsep engine", 0)) == NULL) {
 		errstr = "RSA_meth_new";
@@ -775,29 +772,6 @@ rsa_engine_init(void)
 	RSA_meth_set_finish(rsae_method, rsae_finish);
 	RSA_meth_set_keygen(rsae_method, rsae_keygen);
 
-	if ((e = ENGINE_get_default_RSA()) == NULL) {
-		if ((e = ENGINE_new()) == NULL) {
-			errstr = "ENGINE_new";
-			goto fail;
-		}
-		if (!ENGINE_set_name(e, RSA_meth_get0_name(rsae_method))) {
-			errstr = "ENGINE_set_name";
-			goto fail;
-		}
-		if ((rsa_default = RSA_get_default_method()) == NULL) {
-			errstr = "RSA_get_default_method";
-			goto fail;
-		}
-	} else if ((rsa_default = ENGINE_get_RSA(e)) == NULL) {
-		errstr = "ENGINE_get_RSA";
-		goto fail;
-	}
-
-	if ((name = ENGINE_get_name(e)) == NULL)
-		name = "unknown RSA engine";
-
-	log_debug("debug: %s: using %s", __func__, name);
-
 	if (RSA_meth_get_mod_exp(rsa_default) == NULL)
 		RSA_meth_set_mod_exp(rsae_method, NULL);
 	if (RSA_meth_get_bn_mod_exp(rsa_default) == NULL)
@@ -809,14 +783,7 @@ rsa_engine_init(void)
 	RSA_meth_set0_app_data(rsae_method,
 		RSA_meth_get0_app_data(rsa_default));
 
-	if (!ENGINE_set_RSA(e, rsae_method)) {
-		errstr = "ENGINE_set_RSA";
-		goto fail;
-	}
-	if (!ENGINE_set_default_RSA(e)) {
-		errstr = "ENGINE_set_default_RSA";
-		goto fail;
-	}
+	RSA_set_default_method(rsae_method);
 
 	return;
 
@@ -829,8 +796,12 @@ rsa_engine_init(void)
 static void
 ecdsa_engine_init(void)
 {
-	ENGINE		*e;
-	const char	*errstr, *name;
+	const char	*errstr;
+
+	if ((ecdsa_default = EC_KEY_get_default_method()) == NULL) {
+		errstr = "EC_KEY_get_default_method";
+		goto fail;
+	}
 
 	if ((ecdsae_method = ECDSA_METHOD_new_temporary("ECDSA privsep engine", 0)) == NULL) {
 		errstr = "ECDSA_METHOD_new_temporary";
@@ -841,37 +812,7 @@ ecdsa_engine_init(void)
 	ecdsae_method->ecdsa_sign_setup = ecdsae_sign_setup;
 	ecdsae_method->ecdsa_do_verify = ecdsae_do_verify;
 
-	if ((e = ENGINE_get_default_ECDSA()) == NULL) {
-		if ((e = ENGINE_new()) == NULL) {
-			errstr = "ENGINE_new";
-			goto fail;
-		}
-		if (!ENGINE_set_name(e, ecdsae_method->name)) {
-			errstr = "ENGINE_set_name";
-			goto fail;
-		}
-		if ((ecdsa_default = ECDSA_get_default_method()) == NULL) {
-			errstr = "ECDSA_get_default_method";
-			goto fail;
-		}
-	} else if ((ecdsa_default = ENGINE_get_ECDSA(e)) == NULL) {
-		errstr = "ENGINE_get_ECDSA";
-		goto fail;
-	}
-
-	if ((name = ENGINE_get_name(e)) == NULL)
-		name = "unknown ECDSA engine";
-
-	log_debug("debug: %s: using %s", __func__, name);
-
-	if (!ENGINE_set_ECDSA(e, ecdsae_method)) {
-		errstr = "ENGINE_set_ECDSA";
-		goto fail;
-	}
-	if (!ENGINE_set_default_ECDSA(e)) {
-		errstr = "ENGINE_set_default_ECDSA";
-		goto fail;
-	}
+	EC_KEY_set_default_method(ecdsae_method);
 
 	return;
 
@@ -883,8 +824,12 @@ ecdsa_engine_init(void)
 static void
 ecdsa_engine_init(void)
 {
-	ENGINE		*e;
-	const char	*errstr, *name;
+	const char	*errstr;
+
+	if ((ecdsa_default = EC_KEY_get_default_method()) == NULL) {
+		errstr = "EC_KEY_get_default_method";
+		goto fail;
+	}
 
 	if ((ecdsae_method = EC_KEY_METHOD_new(NULL)) == NULL) {
 		errstr = "EC_KEY_new";
@@ -897,37 +842,8 @@ ecdsa_engine_init(void)
 	    ecdsae_do_sign);
 	EC_KEY_METHOD_set_verify(ecdsae_method, ecdsae_verify, ecdsae_do_verify);
 
-	if ((e = ENGINE_get_default_EC()) == NULL) {
-		if ((e = ENGINE_new()) == NULL) {
-			errstr = "ENGINE_new";
-			goto fail;
-		}
-		if (!ENGINE_set_name(e, "ECDSA privsep engine")) {
-			errstr = "ENGINE_set_name";
-			goto fail;
-		}
-		if ((ecdsa_default = EC_KEY_get_default_method()) == NULL) {
-			errstr = "EC_KEY_get_default_method";
-			goto fail;
-		}
-	} else if ((ecdsa_default = ENGINE_get_EC(e)) == NULL) {
-		errstr = "ENGINE_get_EC";
-		goto fail;
-	}
+	EC_KEY_set_default_method(ecdsae_method);
 
-	if ((name = ENGINE_get_name(e)) == NULL)
-		name = "unknown ECDSA engine";
-	
-	log_debug("debug: %s: using %s", __func__, name);
-
-	if (!ENGINE_set_EC(e, ecdsae_method)) {
-		errstr = "ENGINE_set_EC";
-		goto fail;
-	}
-	if (!ENGINE_set_default_EC(e)) {
-		errstr = "ENGINE_set_default_EC";
-		goto fail;
-	}
 	return;
 
  fail:
