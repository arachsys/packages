require rust

check() {
  url https://github.com/typst/typst/tags
  match version 0.14.2 'tags/v([0-9.]+)\.tar'
}

prepare() {
  unpack typst-0.14.2.tar.gz \
    https://github.com/typst/typst/archive/refs/tags/v0.14.2.tar.gz
  cargo vendor >>.cargo/config.toml
  apply libressl.diff
  tree fec9ec68ae55f35527e272511bae5ef5a9ea9c05b224158f0ec3a4344e84b420
}

build() {
  OPENSSL_INCLUDE_DIR=/lib/include OPENSSL_LIB_DIR=/lib/shared \
    cargo build --release
  install -t /dst/bin -D target/release/typst
}
