mode autotools
require expat

check() {
  url https://nlnetlabs.nl/downloads/unbound/
  match version 1.13.2 'unbound-([0-9.]+)\.tar'
}

prepare() {
  unpack https://nlnetlabs.nl/downloads/unbound/unbound-1.13.2.tar.gz
  tree 1977e7edac58f0942da57ab72a55a9125090e1f46b898f30e037749ea61e5d8c
}

config-extra --disable-{rpath,shared} --with-conf-file=/etc/unbound.conf \
  --with-{libexpat,ssl}=/lib --with-run-dir=/run/unbound --with-username=dns

post-install() {
  rm -f -r /dst/include /dst/lib
  image - requires expat
}
