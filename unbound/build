mode autotools
require expat

check() {
  url https://nlnetlabs.nl/downloads/unbound/
  match version 1.14.0 'unbound-([0-9.]+)\.tar'
}

prepare() {
  unpack https://nlnetlabs.nl/downloads/unbound/unbound-1.14.0.tar.gz
  tree 4e52cddbafe042dd1f276f781e04adcfb5d66a956d7ab44b3384184a2e7fcf7c
}

config-extra --disable-{rpath,shared} --with-conf-file=/etc/unbound.conf \
  --with-{libexpat,ssl}=/lib --with-run-dir=/run/unbound --with-username=dns

post-install() {
  rm -f -r /dst/include /dst/lib
  image - requires expat
}
